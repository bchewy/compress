(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[18],{4056:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(7876),i=s(4232),r=s(7328),n=s.n(r),l=s(5105),o=s.n(l),c=s(8537);function d(){let[e,t]=(0,i.useState)([]),[s,r]=(0,i.useState)([]),[l,d]=(0,i.useState)(50),[h,u]=(0,i.useState)(150),[g,m]=(0,i.useState)(!1),[p,f]=(0,i.useState)(!0),[x,j]=(0,i.useState)(!1),[w,y]=(0,i.useState)(""),[b,v]=(0,i.useState)(!1),[P,D]=(0,i.useState)(null),[k,F]=(0,i.useState)(null),C=(0,i.useRef)(null),N=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e="true"===localStorage.getItem("debugMode"),t="false"!==localStorage.getItem("enableOcr"),s=localStorage.getItem("mistralApiKey");j(e),f(t),s&&y("••••••••••••••••"),c.mj.isDebugMode=e,(0,c.ET)().catch(e=>{console.error("Failed to load AWS configuration:",e)})},[]);let A=e=>{let s=Array.from(e).filter(e=>"application/pdf"===e.type);if(0===s.length)return void alert("Please select only PDF files.");t(e=>[...e,...s])},S=e=>{t(t=>t.filter((t,s)=>s!==e))},E=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},I=async()=>{if(0===e.length)return void alert("Please select at least one PDF file to compress.");v(!0),r([]);let t=null;g&&(t=await window.PDFLib.PDFDocument.create());let s=[],a=e.length;try{for(let i=0;i<a;i++){let r=e[i];console.log("Processing file ".concat(i+1,"/").concat(a,": ").concat(r.name));let n=e=>{console.log("File ".concat(i+1," progress: ").concat(e,"%"))},o=await (0,c.lA)(r,l,h,n);s.push(o),g&&t&&await (0,c.w$)(o,t)}if(r(s),g&&t){let e=await t.save(),s=new Blob([e],{type:"application/pdf"}),a=new File([s],"combined.pdf",{type:"application/pdf"});if(D(a),p)try{let e;a.size>0xa00000?(c.mj.log("PDF is large, using chunking approach for OCR"),e=await (0,c.qC)(a)):(c.mj.log("Processing PDF with standard OCR approach"),e=await (0,c.Ek)(a)),F(e)}catch(e){c.mj.error("Error during OCR processing:",e),alert("Error during OCR processing: "+e.message)}}}catch(e){console.error("Error processing files:",e),alert("Error processing files: "+e.message)}v(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"Ultra-Compress PDF"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"})]}),(0,a.jsx)(o(),{src:"https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js",strategy:"beforeInteractive"}),(0,a.jsx)(o(),{src:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js",strategy:"beforeInteractive"}),(0,a.jsx)(o(),{src:"https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js",strategy:"beforeInteractive"}),(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("h1",{children:"compress.bchwy.com"}),(0,a.jsxs)("div",{className:"subtitle",children:[(0,a.jsx)("p",{children:"Drop your PDFs here to compress them while keeping them readable for humans and LLMs"}),(0,a.jsxs)("a",{href:"https://github.com/bchewy/compress",className:"github-link",target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)("svg",{height:"24",viewBox:"0 0 16 16",width:"24",className:"github-icon",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),"GitHub Repository"]})]}),(0,a.jsxs)("details",{className:"how-it-works-collapsible",children:[(0,a.jsx)("summary",{children:"How It Works"}),(0,a.jsxs)("div",{className:"how-it-works",children:[(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("div",{className:"feature-icon",children:"\uD83D\uDCC4"}),(0,a.jsxs)("div",{className:"feature-content",children:[(0,a.jsx)("h3",{children:"PDF Compression"}),(0,a.jsx)("p",{children:"Our compression engine intelligently reduces PDF file sizes while maintaining readability:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Converts each page to an optimized image at your selected DPI"}),(0,a.jsx)("li",{children:"Applies JPEG compression using your chosen quality setting"}),(0,a.jsx)("li",{children:"Rebuilds a new, lightweight PDF with the optimized images"})]}),(0,a.jsx)("p",{className:"feature-note",children:"Result: Files that are 70-90% smaller but still perfectly readable by both humans and AI systems."})]})]}),(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("div",{className:"feature-icon",children:"\uD83D\uDCDA"}),(0,a.jsxs)("div",{className:"feature-content",children:[(0,a.jsx)("h3",{children:"PDF Combination"}),(0,a.jsx)("p",{children:"Merge multiple documents into a single, organized PDF:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Compresses each document with your specified settings"}),(0,a.jsx)("li",{children:"Preserves document order as arranged in your file list"}),(0,a.jsx)("li",{children:"Combines all pages into a clean, unified document"})]}),(0,a.jsx)("p",{className:"feature-note",children:"Perfect for creating course materials, reports, or documentation from multiple sources."})]})]}),(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("div",{className:"feature-icon",children:"\uD83D\uDD0D"}),(0,a.jsxs)("div",{className:"feature-content",children:[(0,a.jsx)("h3",{children:"OCR Processing"}),(0,a.jsx)("p",{children:"Extract and analyze text from your combined documents:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Securely uploads your PDF to AWS S3 with a temporary pre-signed URL"}),(0,a.jsx)("li",{children:"Processes the document through Mistral AI's advanced OCR service"}),(0,a.jsx)("li",{children:"Extracts text from all content, including images and scanned pages"}),(0,a.jsx)("li",{children:"Automatically deletes your file from S3 after processing"}),(0,a.jsx)("li",{children:"Provides document metadata and downloadable extracted text"})]}),(0,a.jsx)("p",{className:"feature-note",children:"Your files remain private and are only temporarily stored during the OCR process."})]})]})]})]}),(0,a.jsxs)("div",{ref:N,className:"drop-area",onDragOver:e=>{var t;e.preventDefault(),null==(t=N.current)||t.classList.add("highlight")},onDragLeave:()=>{var e;null==(e=N.current)||e.classList.remove("highlight")},onDrop:e=>{var t;e.preventDefault(),null==(t=N.current)||t.classList.remove("highlight"),A(e.dataTransfer.files)},children:[(0,a.jsx)("p",{children:"Drop PDF files here or"}),(0,a.jsx)("input",{ref:C,type:"file",accept:".pdf",multiple:!0,hidden:!0,onChange:e=>{A(e.target.files)}}),(0,a.jsx)("button",{onClick:()=>{var e;return null==(e=C.current)?void 0:e.click()},children:"Select Files"})]}),e.length>0&&(0,a.jsxs)("div",{id:"file-list-container",children:[(0,a.jsx)("h3",{children:"Files to Process"}),(0,a.jsx)("p",{className:"reorder-hint",children:"Drag and drop to reorder files"}),(0,a.jsx)("div",{className:"file-list",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"file-item",children:[(0,a.jsx)("div",{className:"drag-handle",children:"⋮⋮"}),(0,a.jsxs)("div",{className:"file-details",children:[(0,a.jsx)("div",{className:"file-name",children:e.name}),(0,a.jsx)("div",{className:"file-size",children:E(e.size)})]}),(0,a.jsx)("button",{className:"remove-btn",onClick:()=>S(t),children:"\xd7"})]},t))})]}),(0,a.jsxs)("div",{className:"compression-options",children:[(0,a.jsx)("h3",{children:"Compression Options"}),(0,a.jsxs)("div",{className:"option",children:[(0,a.jsx)("label",{htmlFor:"quality",children:"Image Quality (lower = smaller size):"}),(0,a.jsx)("input",{type:"range",id:"quality",min:"1",max:"100",value:l,onChange:e=>d(parseInt(e.target.value))}),(0,a.jsxs)("span",{children:[l,"%"]})]}),(0,a.jsxs)("div",{className:"option",children:[(0,a.jsx)("label",{htmlFor:"dpi",children:"Resolution (DPI):"}),(0,a.jsx)("input",{type:"range",id:"dpi",min:"72",max:"300",value:h,onChange:e=>u(parseInt(e.target.value))}),(0,a.jsxs)("span",{children:[h," DPI"]})]}),(0,a.jsxs)("div",{className:"combine-option",children:[(0,a.jsx)("input",{type:"checkbox",id:"combineFiles",checked:g,onChange:e=>m(e.target.checked)}),(0,a.jsx)("label",{htmlFor:"combineFiles",children:"Combine all PDFs into a single file"})]}),(0,a.jsx)("div",{className:"api-settings",children:(0,a.jsxs)("details",{children:[(0,a.jsx)("summary",{children:"OCR Settings"}),(0,a.jsxs)("div",{className:"api-key-settings",children:[(0,a.jsxs)("div",{className:"option-row",children:[(0,a.jsx)("input",{type:"checkbox",id:"enableOcr",checked:p,onChange:e=>{let t=e.target.checked;f(t),localStorage.setItem("enableOcr",t)}}),(0,a.jsx)("label",{htmlFor:"enableOcr",children:"Enable OCR analysis for combined PDF"})]}),(0,a.jsxs)("div",{className:"option-row",children:[(0,a.jsx)("input",{type:"checkbox",id:"debugMode",checked:x,onChange:e=>{let t=e.target.checked;j(t),localStorage.setItem("debugMode",t),c.mj.isDebugMode=t}}),(0,a.jsx)("label",{htmlFor:"debugMode",children:"Enable Debug Mode (console logs)"})]}),(0,a.jsx)("label",{htmlFor:"mistralApiKey",children:"Mistral API Key:"}),(0,a.jsxs)("div",{className:"api-key-input",children:[(0,a.jsx)("input",{type:"password",id:"mistralApiKey",placeholder:"Enter your Mistral API key",value:w,onChange:e=>y(e.target.value)}),(0,a.jsx)("button",{onClick:()=>{let e=w.trim();e&&"••••••••••••••••"!==e?(localStorage.setItem("mistralApiKey",e),y("••••••••••••••••"),alert("API key saved successfully!")):alert("Please enter an API key.")},children:"Save"}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("mistralApiKey"),y(""),alert("API key cleared.")},children:"Clear"})]}),(0,a.jsx)("p",{className:"api-key-info",children:"Required for analyzing combined PDFs with OCR. Your API key is stored locally in your browser."})]})]})}),(0,a.jsx)("button",{id:"compressBtn",disabled:0===e.length||b,onClick:I,children:b?"Processing...":"Compress Files"})]}),(0,a.jsxs)("div",{className:"results",style:{display:s.length>0?"block":"none"},children:[(0,a.jsx)("h3",{children:"Results"}),(0,a.jsx)("div",{id:"result-list",children:s.map((t,s)=>{let i=e[s],r=i?((i.size-t.size)/i.size*100).toFixed(2):0;return(0,a.jsxs)("div",{className:"result-item",children:[(0,a.jsx)("div",{className:"result-header",children:(0,a.jsx)("div",{className:"file-name",children:t.name})}),(0,a.jsxs)("div",{className:"result-details",children:[(0,a.jsxs)("div",{className:"size-comparison",children:[(0,a.jsxs)("span",{children:["Original: ",i?E(i.size):"Unknown"]}),(0,a.jsx)("span",{children:" → "}),(0,a.jsxs)("span",{children:["Compressed: ",E(t.size)]}),(0,a.jsxs)("span",{className:"reduction",children:[" (",r,"% smaller)"]})]}),(0,a.jsx)("div",{className:"actions",children:(0,a.jsx)("button",{onClick:()=>(0,c.PE)(t),children:"Download"})})]})]},s)})}),(0,a.jsxs)("div",{className:"download-all-container",children:[(0,a.jsx)("button",{disabled:0===s.length,onClick:()=>{(0,c.zg)(s)},children:"Download All"}),(0,a.jsx)("button",{disabled:!P,onClick:()=>{P&&(0,c.PE)(P,"")},children:"Download Combined PDF"})]})]})]})]})}function h(){return(0,a.jsx)(d,{})}},5105:(e,t,s)=>{e.exports=s(7195)},6252:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/pdf",function(){return s(4056)}])},7328:(e,t,s)=>{e.exports=s(9836)},8537:(e,t,s)=>{"use strict";s.d(t,{ET:()=>r,Ek:()=>g,PE:()=>d,lA:()=>n,mj:()=>i,qC:()=>u,v7:()=>c,w$:()=>o,zg:()=>h});{let e=()=>{window.pdfjsLib?window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js":setTimeout(e,100)};e()}let a={region:"",credentials:{accessKeyId:"",secretAccessKey:""},bucketName:""},i={isDebugMode:!1,log:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];this.isDebugMode&&console.log(e,...s)},warn:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];this.isDebugMode?console.warn(e,...s):console.warn("[WARNING]",e,...s)},error:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];console.error(e,...s)}};async function r(){try{i.log("Loading AWS configuration from server...");let e=await fetch("/api/aws-config");if(!e.ok)throw Error("Failed to load AWS config: ".concat(e.status," ").concat(e.statusText));let t=await e.json();a.region=t.region,a.credentials.accessKeyId=t.credentials.accessKeyId,a.credentials.secretAccessKey=t.credentials.secretAccessKey,a.bucketName=t.bucketName,i.log("AWS configuration loaded successfully")}catch(e){throw i.error("Error loading AWS configuration:",e),e}}async function n(e,t,s,a){let i=0;for(;i<50&&(void 0===window.pdfjsLib||void 0===window.PDFLib);)await new Promise(e=>setTimeout(e,100)),i++;if(void 0===window.pdfjsLib||void 0===window.PDFLib)throw Error("PDF libraries not loaded. Please refresh the page and try again.");let r=window.pdfjsLib,n=window.PDFLib,o=t/100,c=await e.arrayBuffer(),d=await r.getDocument({data:c}).promise,h=d.numPages,u=await n.PDFDocument.create();for(let e=1;e<=h;e++){a((e-1)/h*100);let t=await d.getPage(e),i=s/96,r=t.getViewport({scale:i}),n=document.createElement("canvas"),c=n.getContext("2d");n.width=r.width,n.height=r.height,await t.render({canvasContext:c,viewport:r}).promise;let g=n.toDataURL("image/jpeg",o),m=await l(g),p=await u.embedJpg(m);u.addPage([r.width,r.height]).drawImage(p,{x:0,y:0,width:r.width,height:r.height})}return a(100),new File([await u.save()],e.name,{type:"application/pdf"})}async function l(e){let t=atob(e.split(",")[1]),s=new Uint8Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return s}async function o(e,t){if("undefined"==typeof PDFLib)throw Error("PDFLib not loaded");try{i.log("Adding file to combined PDF:",e.name,"Size:",c(e.size)),i.log("Creating a fresh copy of the file using slice(0)");let s=e.slice(0),a=await s.arrayBuffer();i.log("ArrayBuffer created successfully, byteLength:",a.byteLength),i.log("Loading PDF from ArrayBuffer with PDFLib...");let r=await PDFLib.PDFDocument.load(a);i.log("Copying pages from source to target...");let n=r.getPageCount(),l=await t.copyPages(r,[...Array(n).keys()]);for(let e of l)t.addPage(e);return i.log("Successfully copied",l.length,"pages"),!0}catch(e){throw i.error("Error adding to combined PDF:",e),Error("Failed to add to combined PDF: "+e.message)}}function c(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"compressed_",s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="".concat(t).concat(e.name),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}function h(e){0!==e.length&&e.forEach((e,t)=>{setTimeout(()=>{d(e)},500*t)})}async function u(e){i.log("Processing large PDF in chunks:",e.name);try{let t=await e.slice(0).arrayBuffer(),s=(await pdfjsLib.getDocument({data:t}).promise).numPages;i.log("PDF has ".concat(s," pages, will process in chunks"));let a=e.size/1048576,r=5;a>30?r=2:a>20?r=3:a>10&&(r=4),i.log("Using chunk size of ".concat(r," pages based on PDF size (").concat(a.toFixed(2)," MB)"));let n=[];for(let e=1;e<=s;e+=r){let t=Math.min(e+r-1,s);n.push({startPage:e,endPage:t})}i.log("Split PDF into ".concat(n.length," chunks for processing"));let l=[],o=0;for(let t=0;t<n.length;t++){let s=n[t];i.log("Processing chunk ".concat(t+1,"/").concat(n.length," (pages ").concat(s.startPage,"-").concat(s.endPage,")"));try{let a=await PDFLib.PDFDocument.create(),r=await e.slice(0).arrayBuffer(),n=await PDFLib.PDFDocument.load(r),d=[];for(let e=s.startPage-1;e<s.endPage;e++)d.push(e);(await a.copyPages(n,d)).forEach(e=>a.addPage(e));let h=await a.save(),u=new File([h],"chunk_".concat(t+1,"_").concat(e.name),{type:"application/pdf"});i.log("Sending chunk ".concat(t+1," to OCR service (").concat(c(u.size),")"));let m=await g(u);m?(l.push(m),i.log("Successfully processed chunk ".concat(t+1))):(i.warn("Failed to process chunk ".concat(t+1," - no results returned")),o++)}catch(e){if(i.error("Error processing chunk ".concat(t+1,":"),e),++o>2&&o/(t+1)>.5)throw i.error("Too many chunks failing, aborting chunked processing"),Error("Multiple chunk processing failures - OCR may not be working properly")}let a=2e3+1e3*Math.random();i.log("Waiting ".concat(Math.round(a/1e3)," seconds before processing next chunk...")),await new Promise(e=>setTimeout(e,a))}if(0===l.length)throw Error("Failed to process any chunks of the PDF");let d={pageCount:s,totalWords:l.reduce((e,t)=>e+(t.totalWords||0),0),language:l[0].language,hasImages:l.some(e=>e.hasImages),extractedText:l.map(e=>e.extractedText||"").join("\n\n"),fullText:l.map(e=>e.fullText||"").join("\n\n"),images:[]};return l.forEach((e,t)=>{if(e.images&&e.images.length>0){let s=n[t].startPage;e.images.forEach(e=>{let t={...e};t.pageIndex=s-1+e.pageIndex,d.images.push(t)})}}),i.log("Successfully processed all chunks, combined ".concat(d.images.length," images")),d}catch(e){throw i.error("Error processing large PDF in chunks:",e),e}}async function g(e){return i.log("OCR analysis would be implemented here for:",e.name),{pageCount:1,totalWords:100,language:"en",hasImages:!1,extractedText:"Sample extracted text...",fullText:"Sample full text...",images:[]}}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6252)),_N_E=e.O()}]);